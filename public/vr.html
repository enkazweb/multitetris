<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MultiTetris VR - Meta Quest 3</title>
  
  <!-- A-Frame VR Framework -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <!-- A-Frame Extras (Controller desteÄŸi) -->
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #0a0a1a;
      color: white;
      overflow: hidden;
    }
    
    /* VR'a girmeden Ã¶nceki UI */
    #ui-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3e 50%, #0f2460 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    #ui-overlay.hidden {
      display: none;
    }
    
    .vr-logo {
      font-size: 48px;
      font-weight: bold;
      background: linear-gradient(180deg, #00f5ff, #b06bff, #ff6b6b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }
    
    .vr-subtitle {
      font-size: 18px;
      color: #00f5ff;
      margin-bottom: 40px;
    }
    
    .vr-input {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      padding: 15px 25px;
      font-size: 18px;
      color: white;
      text-align: center;
      width: 280px;
      margin-bottom: 15px;
      outline: none;
    }
    
    .vr-input:focus {
      border-color: #00f5ff;
    }
    
    .vr-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }
    
    .vr-btn {
      padding: 18px 40px;
      font-size: 18px;
      font-weight: bold;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      margin: 10px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .vr-btn-primary {
      background: linear-gradient(145deg, #00f5ff, #0099cc);
      color: #000;
      box-shadow: 0 0 30px rgba(0, 245, 255, 0.4);
    }
    
    .vr-btn-secondary {
      background: linear-gradient(145deg, #b06bff, #8a53cc);
      color: white;
      box-shadow: 0 0 20px rgba(176, 107, 255, 0.3);
    }
    
    .vr-btn:hover {
      transform: scale(1.05);
    }
    
    .vr-btn:active {
      transform: scale(0.95);
    }
    
    .join-row {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .join-row .vr-input {
      width: 180px;
      text-transform: uppercase;
      letter-spacing: 3px;
    }
    
    .vr-hint {
      margin-top: 30px;
      color: rgba(255, 255, 255, 0.5);
      font-size: 14px;
    }
    
    .vr-status {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 16px;
      z-index: 1001;
    }
    
    /* Lobby ekranÄ± */
    #lobby-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    
    #lobby-overlay.hidden {
      display: none;
    }
    
    .room-code-display {
      font-size: 64px;
      font-weight: bold;
      color: #ffd93d;
      letter-spacing: 15px;
      text-shadow: 0 0 30px rgba(255, 217, 61, 0.5);
      margin: 20px 0;
    }
    
    .player-slots {
      display: flex;
      gap: 40px;
      margin: 30px 0;
    }
    
    .player-slot {
      background: rgba(255, 255, 255, 0.1);
      border: 3px solid rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      padding: 30px 50px;
      text-align: center;
      min-width: 200px;
    }
    
    .player-slot.ready {
      border-color: #6bcb77;
      box-shadow: 0 0 30px rgba(107, 203, 119, 0.4);
    }
    
    .player-slot .name {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .player-slot .status {
      font-size: 36px;
    }
    
    .vs-text {
      font-size: 32px;
      color: #ffd93d;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Ana MenÃ¼ Overlay -->
  <div id="ui-overlay">
    <div class="vr-logo">ðŸ¥½ MultiTetris VR</div>
    <div class="vr-subtitle">Meta Quest 3 - Multiplayer 3D Tetris</div>
    
    <input type="text" id="player-name" class="vr-input" placeholder="AdÄ±nÄ±z" maxlength="12">
    
    <button id="create-room-btn" class="vr-btn vr-btn-primary">ðŸŽ® ODA OLUÅžTUR</button>
    
    <div class="join-row">
      <input type="text" id="room-code-input" class="vr-input" placeholder="Oda Kodu" maxlength="6">
      <button id="join-room-btn" class="vr-btn vr-btn-secondary">KATIL</button>
    </div>
    
    <p class="vr-hint">VR baÅŸlÄ±ÄŸÄ±nÄ±zÄ± takÄ±n ve arkadaÅŸÄ±nÄ±zla 3D Tetris oynayÄ±n!</p>
  </div>
  
  <!-- Lobby Overlay -->
  <div id="lobby-overlay" class="hidden">
    <div class="vr-subtitle">ODA KODU</div>
    <div class="room-code-display" id="display-room-code"></div>
    
    <div class="player-slots">
      <div class="player-slot" id="player1-slot">
        <div class="name">Bekleniyor...</div>
        <div class="status"></div>
      </div>
      <div class="vs-text">VS</div>
      <div class="player-slot" id="player2-slot">
        <div class="name">Bekleniyor...</div>
        <div class="status"></div>
      </div>
    </div>
    
    <button id="ready-btn" class="vr-btn vr-btn-primary">âœ“ HAZIRIM</button>
    <button id="enter-vr-btn" class="vr-btn vr-btn-secondary" style="display: none;">ðŸ¥½ VR'A GÄ°R</button>
    
    <p class="vr-hint">Ä°ki oyuncu da hazÄ±r olunca VR dÃ¼nyasÄ±na girersiniz!</p>
  </div>
  
  <!-- A-Frame VR Sahne - YÃ¼ksek Ã‡Ã¶zÃ¼nÃ¼rlÃ¼k -->
  <a-scene 
    id="vr-scene"
    webxr="optionalFeatures: local-floor, bounded-floor, hand-tracking, layers"
    renderer="antialias: true; colorManagement: true; physicallyCorrectLights: true; highRefreshRate: true; foveationLevel: 0; multiviewStereo: true"
    background="color: #0a0a1a"
    vr-mode-ui="enabled: true"
    loading-screen="enabled: false">
    
    <!-- Assets -->
    <a-assets>
      <a-mixin id="block-material" material="metalness: 0.3; roughness: 0.7"></a-mixin>
    </a-assets>
    
    <!-- Ortam IÅŸÄ±klarÄ± -->
    <a-entity light="type: ambient; color: #404060; intensity: 0.4"></a-entity>
    <a-entity light="type: directional; color: #ffffff; intensity: 0.8" position="0 10 5"></a-entity>
    <a-entity light="type: point; color: #00f5ff; intensity: 0.5; distance: 20" position="-3 3 -2"></a-entity>
    <a-entity light="type: point; color: #ff6b6b; intensity: 0.5; distance: 20" position="3 3 -2"></a-entity>
    
    <!-- Skybox / Arka Plan -->
    <a-sky color="#0a0a1a"></a-sky>
    
    <!-- Zemin ve parÃ§acÄ±klar JavaScript ile oluÅŸturuluyor -->
    
    <!-- Ana Oyun AlanÄ± -->
    <a-entity id="game-area" position="0 1.2 -2.5">
      
      <!-- Benim Board'um (Sol) - Hafif aÃ§Ä±lÄ± 3D perspektif -->
      <a-entity id="my-board-container" position="-1.2 0 0" rotation="0 15 0">
        <!-- Board arka planÄ± - Derin kutu -->
        <a-box 
          id="my-board-bg"
          width="1.1" 
          height="2.2" 
          depth="0.25"
          material="color: #0a0a14; opacity: 0.95; transparent: true"
          position="0 0 -0.125">
        </a-box>
        <!-- Ä°Ã§ derinlik katmanÄ± -->
        <a-box 
          width="1.05" 
          height="2.15" 
          depth="0.02"
          material="color: #050508; opacity: 1"
          position="0 0 -0.01">
        </a-box>
        <!-- Board Ã§erÃ§evesi - Neon -->
        <a-box 
          width="1.15" 
          height="2.25" 
          depth="0.28"
          material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 0.5; opacity: 0.2; transparent: true"
          position="0 0 -0.14">
        </a-box>
        <!-- Ãœst kenar glow -->
        <a-box 
          width="1.12" 
          height="0.02" 
          depth="0.26"
          material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 1"
          position="0 1.12 -0.13">
        </a-box>
        <!-- Alt kenar glow -->
        <a-box 
          width="1.12" 
          height="0.02" 
          depth="0.26"
          material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 1"
          position="0 -1.12 -0.13">
        </a-box>
        <!-- 3D Bloklar buraya eklenecek -->
        <a-entity id="my-blocks"></a-entity>
        <!-- Mevcut parÃ§a -->
        <a-entity id="my-current-piece"></a-entity>
        
        <!-- Ä°sim ve Skor -->
        <a-text 
          id="my-name-text"
          value="Ben" 
          position="0 1.3 0" 
          align="center" 
          color="#00f5ff"
          width="3">
        </a-text>
        <a-text 
          id="my-score-text"
          value="0" 
          position="0 1.15 0" 
          align="center" 
          color="#ffffff"
          width="4"
          font="mozillavr">
        </a-text>
      </a-entity>
      
      <!-- VS YazÄ±sÄ± (Orta) -->
      <a-text 
        value="VS" 
        position="0 0.5 0" 
        align="center" 
        color="#ffd93d"
        width="5"
        font="mozillavr">
      </a-text>
      
      <!-- Rakip Board'u (SaÄŸ) - Hafif aÃ§Ä±lÄ± 3D perspektif -->
      <a-entity id="opponent-board-container" position="1.2 0 0" rotation="0 -15 0">
        <!-- Board arka planÄ± - Derin kutu -->
        <a-box 
          id="opponent-board-bg"
          width="1.1" 
          height="2.2" 
          depth="0.25"
          material="color: #0a0a14; opacity: 0.95; transparent: true"
          position="0 0 -0.125">
        </a-box>
        <!-- Ä°Ã§ derinlik katmanÄ± -->
        <a-box 
          width="1.05" 
          height="2.15" 
          depth="0.02"
          material="color: #050508; opacity: 1"
          position="0 0 -0.01">
        </a-box>
        <!-- Board Ã§erÃ§evesi - Neon -->
        <a-box 
          width="1.15" 
          height="2.25" 
          depth="0.28"
          material="color: #ff6b6b; emissive: #ff6b6b; emissiveIntensity: 0.5; opacity: 0.2; transparent: true"
          position="0 0 -0.14">
        </a-box>
        <!-- Ãœst kenar glow -->
        <a-box 
          width="1.12" 
          height="0.02" 
          depth="0.26"
          material="color: #ff6b6b; emissive: #ff6b6b; emissiveIntensity: 1"
          position="0 1.12 -0.13">
        </a-box>
        <!-- Alt kenar glow -->
        <a-box 
          width="1.12" 
          height="0.02" 
          depth="0.26"
          material="color: #ff6b6b; emissive: #ff6b6b; emissiveIntensity: 1"
          position="0 -1.12 -0.13">
        </a-box>
        <!-- 3D Bloklar buraya eklenecek -->
        <a-entity id="opponent-blocks"></a-entity>
        <!-- Rakibin mevcut parÃ§asÄ± -->
        <a-entity id="opponent-current-piece"></a-entity>
        
        <!-- Rakip Game Over Overlay -->
        <a-entity id="opponent-status-overlay" position="0 0 0.15" visible="false">
          <a-box 
            width="1" 
            height="0.3" 
            depth="0.02"
            material="color: #000000; opacity: 0.9; transparent: true">
          </a-box>
          <a-text 
            value="OYUN BITTI" 
            position="0 0 0.02" 
            align="center" 
            color="#ff6b6b"
            width="2.5">
          </a-text>
        </a-entity>
        
        <!-- Ä°sim ve Skor -->
        <a-text 
          id="opponent-name-text"
          value="Rakip" 
          position="0 1.3 0" 
          align="center" 
          color="#ff6b6b"
          width="3">
        </a-text>
        <a-text 
          id="opponent-score-text"
          value="0" 
          position="0 1.15 0" 
          align="center" 
          color="#ffffff"
          width="4"
          font="mozillavr">
        </a-text>
      </a-entity>
      
      <!-- Benim Sonraki ParÃ§am -->
      <a-entity id="next-piece-container" position="-2 0.6 0">
        <a-box 
          width="0.5" 
          height="0.5" 
          depth="0.1"
          material="color: #1a1a3e; opacity: 0.8; transparent: true">
        </a-box>
        <a-box 
          width="0.52" 
          height="0.52" 
          depth="0.08"
          material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 0.3; opacity: 0.2; transparent: true"
          position="0 0 -0.02">
        </a-box>
        <a-text 
          value="SIRADAKI" 
          position="0 0.35 0" 
          align="center" 
          color="#00f5ff"
          width="1.5">
        </a-text>
        <a-entity id="next-piece-blocks" position="0 0 0.05"></a-entity>
      </a-entity>
      
      <!-- Rakibin Sonraki ParÃ§asÄ± -->
      <a-entity id="opponent-next-piece-container" position="2 0.6 0">
        <a-box 
          width="0.5" 
          height="0.5" 
          depth="0.1"
          material="color: #1a1a3e; opacity: 0.8; transparent: true">
        </a-box>
        <a-box 
          width="0.52" 
          height="0.52" 
          depth="0.08"
          material="color: #ff6b6b; emissive: #ff6b6b; emissiveIntensity: 0.3; opacity: 0.2; transparent: true"
          position="0 0 -0.02">
        </a-box>
        <a-text 
          value="RAKIP" 
          position="0 0.35 0" 
          align="center" 
          color="#ff6b6b"
          width="1.5">
        </a-text>
        <a-entity id="opponent-next-piece-blocks" position="0 0 0.05"></a-entity>
      </a-entity>
      
    </a-entity>
    
    <!-- VR Kontroller -->
    <a-entity id="left-hand" 
      hand-controls="hand: left; handModelStyle: lowPoly; color: #00f5ff"
      laser-controls="hand: left">
    </a-entity>
    
    <a-entity id="right-hand" 
      hand-controls="hand: right; handModelStyle: lowPoly; color: #ff6b6b"
      laser-controls="hand: right">
    </a-entity>
    
    <!-- Oyuncu KamerasÄ± -->
    <a-entity id="rig" position="0 0 2">
      <a-camera 
        id="camera"
        look-controls="pointerLockEnabled: false"
        wasd-controls="enabled: false">
      </a-camera>
    </a-entity>
    
    <!-- SatÄ±r Silme ParÃ§acÄ±klarÄ± -->
    <a-entity id="clear-particles"></a-entity>
    
    <!-- Rakip Bekleniyor Paneli -->
    <a-entity id="waiting-panel" position="0 1.5 -2" visible="false">
      <a-box 
        width="1.8" 
        height="1" 
        depth="0.1"
        material="color: #0a0a14; opacity: 0.95; transparent: true">
      </a-box>
      <a-box 
        width="1.85" 
        height="1.05" 
        depth="0.08"
        material="color: #ffd93d; emissive: #ffd93d; emissiveIntensity: 0.5; opacity: 0.3; transparent: true"
        position="0 0 -0.02">
      </a-box>
      <a-text 
        value="OYUNUN BITTI!" 
        position="0 0.25 0.06" 
        align="center" 
        color="#ff6b6b"
        width="4"
        font="mozillavr">
      </a-text>
      <a-text 
        id="waiting-score-text"
        value="Skorun: 0" 
        position="0 0 0.06" 
        align="center" 
        color="#ffd93d"
        width="3">
      </a-text>
      <a-text 
        value="Rakip bekleniyor..." 
        position="0 -0.25 0.06" 
        align="center" 
        color="#00f5ff"
        width="3">
      </a-text>
      <!-- DÃ¶nen animasyon -->
      <a-ring 
        position="0 -0.45 0.06"
        radius-inner="0.04"
        radius-outer="0.06"
        material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 0.8"
        animation="property: rotation; to: 0 0 360; dur: 1000; loop: true; easing: linear">
      </a-ring>
    </a-entity>
    
    <!-- Oyun Sonu Paneli -->
    <a-entity id="game-over-panel" position="0 1.5 -2" visible="false">
      <a-box 
        width="2.2" 
        height="1.8" 
        depth="0.1"
        material="color: #1a1a3e; opacity: 0.95; transparent: true">
      </a-box>
      <!-- Neon Ã§erÃ§eve -->
      <a-box 
        width="2.25" 
        height="1.85" 
        depth="0.05"
        material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 0.5; opacity: 0.3; transparent: true"
        position="0 0 -0.03">
      </a-box>
      <a-text 
        id="result-text"
        value="OYUN BÄ°TTÄ°" 
        position="0 0.5 0.06" 
        align="center" 
        color="#ffffff"
        width="5"
        font="mozillavr">
      </a-text>
      <a-text 
        id="final-scores-text"
        value="" 
        position="0 0.1 0.06" 
        align="center" 
        color="#ffd93d"
        width="3.5">
      </a-text>
      <!-- Developer Credit -->
      <a-entity id="developer-credit" position="0 -0.45 0.06" visible="true">
        <a-text 
          value="Gelistiren:" 
          position="0 0.12 0" 
          align="center" 
          color="#888888"
          width="2">
        </a-text>
        <a-text 
          value="Cem YILDIRIM" 
          position="0 0 0" 
          align="center" 
          color="#00f5ff"
          width="2.5"
          font="mozillavr">
        </a-text>
      </a-entity>
      <!-- Yeniden Oyna butonu (VR'da gÃ¶rsel) -->
      <a-box 
        position="0 -0.7 0.05"
        width="0.8" 
        height="0.2" 
        depth="0.05"
        material="color: #00f5ff; emissive: #00f5ff; emissiveIntensity: 0.3">
      </a-box>
      <a-text 
        value="Ana Menu icin Yenile" 
        position="0 -0.7 0.08" 
        align="center" 
        color="#000000"
        width="2">
      </a-text>
    </a-entity>
    
  </a-scene>
  
  <!-- Socket.IO -->
  <script src="/socket.io/socket.io.js"></script>
  
  <!-- VR Oyun Kodu -->
  <script src="vr-game.js"></script>
</body>
</html>
